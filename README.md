# Integration_with_external_service

***Всем привет! Меня зовут Кристина Рожкова. Я учусь в online школе [sky.pro](https://sky.pro/#giftpopup) на phyton разработчика. Данный проект является выполнением домашнего задания на 4 курсе.***

**Контекст:**
В этом проекте предстоит написать интеграцию с внешним сервисом.

Интеграция с внешним сервисом — это довольно распространенная задача для Python-разработчиков, которую можно встретить на платформах с фриланс-проектами.
В курсовой мы будем работать с API.

**Задание**
Напишите программу, которая будет получать информацию о вакансиях с платформы hh.ru в России, сохранять ее в файл и позволять удобно работать с ней: добавлять, фильтровать, удалять.

В рамках требований были выполнены все пункты, однако реализовывался не весь функционал, так как этого не требовало ТЗ.

**Требования к реализации**

- Создать абстрактный класс для работы с API сервиса с вакансиями. Реализовать класс, наследующийся от абстрактного класса, для работы с платформой hh.ru. Класс должен уметь подключаться к API и получать вакансии.

- Создать класс для работы с вакансиями. В этом классе самостоятельно определить атрибуты, такие как название вакансии, ссылка на вакансию, зарплата, краткое описание или требования и т. п. (всего не менее четырех атрибутов). Класс должен поддерживать методы сравнения вакансий между собой по зарплате и валидировать данные, которыми инициализируются его атрибуты.

    Способами валидации данных может быть проверка, указана или нет зарплата. В этом случае выставлять значение зарплаты 0 или «Зарплата не указана» в зависимости от структуры класса.

- Определить абстрактный класс, который обязывает реализовать методы для добавления вакансий в файл, получения данных из файла по указанным критериям и удаления информации о вакансиях. Создать класс для сохранения информации о вакансиях в JSON-файл. Дополнительно, по желанию, можно реализовать классы для работы с другими форматами, например с CSV- или Excel-файлом, с TXT-файлом.

    Данный класс выступит в роли основы для коннектора, заменяя который (класс-коннектор), можно использовать в качестве хранилища одну из баз данных или удаленное хранилище со своей специфической системой обращений.

    В случае если какие-то из методов выглядят не используемыми для работы с файлами, то не стоит их удалять. Они пригодятся для интеграции к БД. Сделайте заглушку в коде.

- Создать функцию для взаимодействия с пользователем. Функция должна взаимодействовать с пользователем через консоль. Возможности этой функции должны быть следующими:

  - ввести поисковый запрос для запроса вакансий из hh.ru;
  
  - получить топ N вакансий по зарплате (N запрашивать у пользователя);
  
  - получить вакансии с ключевым словом в описании.
  
  Помимо этого функционала, можно придумать дополнительные возможности, которые покажутся удобными.

- Объединить все классы и функции в единую программу.

- Покрыть описанный функционал тестами.

**Требования к реализации в парадигме ООП**

- Абстрактный класс и классы для работы с API платформ с вакансиями должны быть реализованы в соответствии с принципом наследования.

- Класс для работы с вакансиями должен быть реализован в соответствии с принципом инкапсуляции и поддерживать методы сравнения вакансий между собой по зарплате.

- Классы и другие сущности в проекте должны удовлетворять минимум первым двум требованиям принципов SOLID.

**Документация для сбора вакансий с hh.ru**

Ссылка на API: https://github.com/hhru/api/.

**Выходные данные**

Информация о вакансиях, полученная с разных платформ, сохраненная в JSON-файл.

Отфильтрованные и отсортированные вакансии, выводимые пользователю через консоль.

## Установка

1. Клонирование репозитория по [HTTPS](https://github.com/Kristina-Rozhkova/Integration_with_external_service.git)
2. Все зависимости описаны в файле **pyproject.toml**, все исключения добавлены в **.gitignore**
---

## Использование

**Пакет src содержит следующие модули:**
- [api_hh.py](src/api_hh.py)
- [vacation.py](src/vacation.py)
- [save_in_file.py](src/save_in_file.py)
- [main.py](src/main.py)


**Пакет data содержит следующие файлы:**
-[save.json](data/save.json) - для сохранения данных и их последующего чтения.
-[vacancies.json](data/vacancies.json) - для чтения данных.


**Пакет tests содержит следующие файлы:**
-[test_data/test_save.json](tests/test_data/test_save.json) - для использования при тестировании модулей
-[conftest.py](tests/conftest.py)
-[test_api_hh.py](tests/test_api_hh.py)
-[test_vacation.py](tests/test_vacation.py)
-[test_save_in_file.py](tests/test_save_in_file.py)

---

## Содержание модулей пакета src

1. [api_hh.py](src/api_hh.py)
   
    - `Parser` - *Абстрактный класс, содержащий абстрактные методы подключения к api и получения вакансий*

    - `HeadHunterParser` - *Класс для получения информации о вакансиях с помощью API hh.ru*
        
        Методы класса:
        1) Инициализация: каждый новый экземпляр класса содержит в себе минимальные необходимые данные для последующей отправки запроса на сайт
        2) _connection - Получение данных с сайта
        3) __connection - Приватный метод, который вызывает защищенный метод _connection
        4) get_vacations - Возвращает полученный список вакансий в формате json, принимает параметр keyword, с помощью которого ищутся необходимые вакансии

2. [vacation.py](src/vacation.py)
Модуль содержит класс Vacation - Класс для работы с вакансиями hh.ru. Для экономии ресурсов памяти и оптимизации работы компьютера используется __slots__.

    - `Инициализация`: на вход принимается вакансия в виде словаря, далее каждый атрибут заполняется на основе имеющихся данных в словаре.
    - `__str__` - строковое представление информации о вакансии для взаимодействия с пользователем
    - `__validation` - *Валидация данных*
    - `_have_salary` - *Метод фильтрации вакансий по наличию зарплаты, запускается при инициализации экземпляра класса*
    - `__le__` - *Метод сравнения зарплаты вакансии на ее минимум*
    - `max_salary` - *Класс-метод сравнения вакансий по зарплате, поиск максимального значения*
    - `choose_min_salary` - *Класс-метод поиска вакансий с фильтрацией по минимальной зарплате*
    - `get_vacancies_without_salary` - *Получение вакансий без информации о зарплате, класс-метод*
    - `clear_vacation_list` - *Очистка списка вакансий*

3. [save_in_file.py](src/save_in_file.py)
Модуль содержит абстрактный класс для сохранения данных в файл и Класс для сохранения данных в JSON-файл.

    - `Инициализация` - *создает экземпляр класса с путем к файлу*
    - `write_down` - *Добавление вакансий в файл*
    - `_read_file` - *Чтение данных файла*
    - `_find_vacancy` - *Поиск вакансий в файле*
    - `get_from` - *Получение данных о вакансии по определенным критериям*
    - `delete_from` - *Удаление информации о вакансиях по заданным критериям*
    - `clear_file` - *Очистка файла (запись пустого списка)*

4. [main.py](src/main.py)
Модуль содержит функцию взаимодействия с пользователем: *work_with_hh_vacancies*.


## Содержание модулей пакета tests

1. [conftest.py](tests/conftest.py)

    - `vacation` - *Фикстура для инициализации нескольких вакансий*
    - `data` - *Фикстура с данными о вакансии после обработки магическим методом __str__ класса Vacation*

2. [test_api_hh.py](tests/test_api_hh.py)

    - `test_get_vacation` - *Тестирование получения вакансии с HeadHunterParser*
    - `test_get_vacation_error` - *Тестирование выброса ошибки при получении ключевого слова, не содержащего букв*
    - `test_init` - *Тестирование инициализации экземпляра класса HeadHunterParser*
    - `test_connection_error` - *Тестирование неуспешного подключения к сайту*

3. [test_vacation.py](tests/test_vacation.py)

    - `test_vacation_init` - *Тестирование инициализации экземпляра класса Vacation*
    - `test_vacation_max_salary` - *Тестирование поиска вакансии с наибольшей зарплатой*
    - `test_vacation_max_salary_in_clear_list` - *Тестирование вывода сообщения, если список вакансий с указанной зарплатой пуст*
    - `test_get_vacancies_without_salary` - *Тестирование получения списка с вакансиями без информации о зарплате*
    - `test_get_vacancies_without_salary_error` - *Тестирование выброса ошибки при пустом списке с вакансиями без информации о зарплате*
    - `test_choose_min_salary` - *Тестирование фильтрации по заданной минимальной зарплате*
    - `test_choose_min_salary_type_error` - *Тестирование выброса ошибки при передаче неправильного типа аргумента в метод choose_min_salary*
    - `test_choose_min_salary_value_error` - *Тестирование выброса ошибки при передаче числа в метод choose_min_salary меньше или равного 0*

4. [test_save_in_file.py](tests/test_save_in_file.py)

    - `test_json_write_down` - *Тестирование добавления информации о вакансиях*
    - `test_file_not_found_error` - *Тестирование вывода сообщения ошибки при попытке прочитать данные в несуществующем файле*
    - `test_json_get_from` - *Тестирование получения информации из файла по заданным критериям*
    - `test_json_delete_from` - *Тестирование удаления вакансий из файла по заданным критериям*
    - `test_clear_file` - *Тестирование очистки файла*